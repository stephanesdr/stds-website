---
import Layout from "@layouts/Layout.astro";
import { useCallback, useMemo } from "react";
import type Project from "@interfaces/project";
import {simpleSchema as projectSchema} from "@interfaces/project";
import HygraphVideo from "@components/HygraphVideoComponent";
import HygraphImage from "@components/HygraphImageComponent";


const query = {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
        query: `
      {
        projects {
			${projectSchema()}
        }
      }`,
    }),
};

const response = await fetch(import.meta.env.ASTRO_APP_HYGRAPH_ENDPOINT, query);
const json = await response.json();
const projects: Project[] = json.data.projects;

---

<Layout title="My main page">
    <div class="project-list  w-full flex flex-row justify-center  gap-4 border-4 border-violet-500">
        <!-- <div class="flex-1"></div> -->
        <div class="relative w-full contents ">
            <div class="w-full relative ">
                {projects && projects.length > 0 && (
                    <div class="w-full my-[50px] flex flex-col items-center">
                        {projects.map((project) => (
                            <div class="relative z-50 p-4 sm:p-0 mb-4 flex flex-col justify-center items-center max-w-md">
                                {project.image && (
                                    <a href={`/projects/${project.slug}/`} data-name="project__a" data-id={project.id}>
                                        <img
                                            class="card card-projects w-full h-full object-cover hover:rounded-3xl mb-[20px] shadow-xl hover:shadow-lg"
                                            data-transition-name="project-card"
                                            src={project.image.url}
                                            alt="A description of my image."
                                        />
                                    </a>
                                )}

                                <a href={`/projects/${project.slug}/`}>
                                    <div class="font-sans text-lg max-w-lg w-[32rem] text-balance pt-20 pb-10 hidden" data-transition-name="project-description">
                                        {project.name},
                                        <br>
                                        <p class="text-balance">
                                            {project.excerpt}
                                        </p>
                                    </div>
                                    
                                </a>
                            </div>
                        ))}
                    </div>
                )}
            </div>
        </div>
        <div class="flex-1"></div>
    </div>
</Layout>


<style is:inline>

    .card-projects {
    transition: all ease-in-out 0.15s;
    position: relative;
  }

  .card-projects:hover {
    transform: scale(0.97);
  }

</style>