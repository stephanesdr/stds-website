---
import Layout from "../layouts/Layout.astro";
import type Asset from "@interfaces/asset";
import  {schema as assetSchema} from "@interfaces/asset";
import { WavyBackground } from "@components/ui/wavy-background";
import HygraphVideo from "@components/HygraphVideoComponent"
import { cn } from "@utils/cn";


interface indexModel {
	title: string;
	image?: Asset

}

const query = {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    query: `
      {
		indices {
		title
		image {
            ${assetSchema()}
        }
  }
      }`,
  }),
};

const response = await fetch(import.meta.env.ASTRO_APP_HYGRAPH_ENDPOINT, query);
const json = await response.json();
const indexElements: indexModel[] = json.data.indices ;

console.log(indexElements[0].image?.url)


---

<WavyBackground className="w-full mx-auto mix-blend-multiply overflow-hidden overflow-y-scroll" client:only="react">	
<Layout title="My main page">
		<main class="w-full h-full">
			
			{ indexElements && indexElements.length > 0 && (
				<div class="border-4 h-full">
					{indexElements.map((index) => ( 
			
							<div class="flex flex-col w-full h-full justify-center items-center">
								{index.image && (
									
										<HygraphVideo
											className={cn(
												"project__video mix-blend-multiply",
												"w-1/3 border-4")}
											src={index.image.url}
											width={index.image.width}
											height={index.image.height}
											mimeType={index.image.mimeType}
										/>
								
								)}
							</div>

					))}	
				</div>
			)}
	
	</main>
</Layout>
</WavyBackground>